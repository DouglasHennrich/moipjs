/*! Moip.js - build date: 2013-06-05 */
var moip={creditCard:{isValid:function(t){t=t.replace(/\s+/g,""),t=t.replace(/\./g,""),t=t.replace(/\-/g,"");var a=this.cardType(t);if(null==a)return!1;if("HIPERCARD"==a.brand)return!0;for(var e=0,n=2-t.length%2;t.length>=n;n+=2)e+=parseInt(t.charAt(n-1));for(var n=t.length%2+1;t.length>n;n+=2){var i=2*parseInt(t.charAt(n-1));e+=10>i?i:i-9}return 0==e%10?!0:!1},cardType:function(t){t=t.replace(/\s+/g,""),t=t.replace(".",""),t=t.replace("-","");var a=/^4\d{3}-?\d{4}-?\d{4}-?\d{4}$/,e=/^5[1-5]\d{2}-?\d{4}-?\d{4}-?\d{4}$/,n=/^3[4,7]\d{13}$/,i=/^3[0,6,8]\d{12}$/,r=/^(606282\d{10}(\d{3})?)|(3841\d{15})$/;return t.match(a)?{brand:"VISA"}:t.match(e)?{brand:"MASTERCARD"}:t.match(n)?{brand:"AMEX"}:t.match(i)?{brand:"DINERS"}:t.match(r)?{brand:"HIPERCARD"}:null},isSecurityCodeValid:function(t,a){var e=moip.creditCard.cardType(t);if("AMEX"==e.brand)var n=4;else var n=3;var i=RegExp("[0-9]{"+n+"}");return a.length==n&&i.test(a)},isExpiryDateValid:function(t,a){var e=new Date,n=e.getMonth()+1,i=e.getYear()+1900,r=!1;return parseInt(a)>=i&&parseInt(t)>=n&&(r=!0),r}},calculator:{pricing:function(t){return this.buildJson(t)},buildJson:function(t){var a,e=[],n=[],r=[],c=[];if(a=this._calculateTransactionTax(t.amount,t.transaction_percentage,t.fixed),void 0!=t.antecipation_percentage&&void 0!=t.floating&&void 0!=t.installment){for(i=0;11>=i;i++)e[i]=this._calculateInstallmentValue(t.amount,i+1),n[i]=this._calculateAntecipationPercentage(a,t,i,t.amount),r[i]=this._calculateTotalTax(n[i],a),c[i]=this._calculateLiquidValue(t.amount,r[i]);return{amount:t.amount,transaction_tax:a,antecipation_percentage:n,total_tax:r,liquid_value:c,installment_value:e}}return c=this._calculateLiquidValue(t.amount,a),{amount:t.amount,transaction_tax:a,liquid_value:c}},pricingWithInterest:function(t){for(var a=[],e=[],n=[],i=[],r=[],c=[],l=[],o=1;12>=o;o++)a[o-1]=this._calculateInterestRate(t.amount,t.interest_rate,o),e[o-1]=this._calculateAmount(a[o-1],o),n[o-1]=this._calculateTransactionTax(e[o-1],t.transaction_percentage,t.fixed),i[o-1]=this._calculateAntecipationPercentage(n[o-1],t,o-1,e[o-1]),r[o-1]=this._calculateAntecipationPercentageFromAmount(e[o-1],i[o-1]),c[o-1]=this._calculateTotalTax(i[o-1],n[o-1]),l[o-1]=this._calculateLiquidValue(e[o-1],c[o-1]);return{amount:e,transaction_tax:n,antecipation_percentage:r,total_tax:c,liquid_value:l,installment_value:a}},_calculateAntecipationPercentageFromAmount:function(t,a){return parseFloat(100*a/(t/100)).toFixed(2)},_calculateTransactionTax:function(t,a,e){return parseFloat(((t*(a/100)+e)/100).toFixed(2))},_calculateAntecipationPercentage:function(t,a,e,n){return parseFloat((parseFloat(a.antecipation_percentage/100/30*(30+15*e-a.floating))*parseFloat(n/100-t)).toFixed(2))},_calculateTotalTax:function(t,a){return parseFloat((t+a).toFixed(2))},_calculateLiquidValue:function(t,a){return parseFloat((t/100-parseFloat(a)).toFixed(2))},_calculateInstallmentValue:function(t,a){return parseFloat((t/a/100).toFixed(2))},_calculateInterestRate:function(t,a,e){return 1==e?parseFloat(t/100):parseFloat((this._coefficient(a,e)*(t/100)).toFixed(2))},_calculateAmount:function(t,a){return parseFloat(100*(t*a).toFixed(2))},_coefficient:function(t,a){return parseFloat((t/100/(1-1/Math.pow(t/100+1,a))).toFixed(10))}}};